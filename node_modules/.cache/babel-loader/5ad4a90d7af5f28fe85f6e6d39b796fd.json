{"ast":null,"code":"var _jsxFileName = \"/Users/ngjunwei/audio-room-2/src/App.js\",\n    _s = $RefreshSig$();\n\nimport { useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const startButtonDisabled = useState(\"false\");\n  const callButtonDisabled = useState(\"true\");\n  const hangupButtonDisabled = useState(\"true\");\n  callButton.disabled = true;\n  hangupButton.disabled = true;\n  startButton.onclick = start;\n  callButton.onclick = call;\n  hangupButton.onclick = hangup;\n  const video1 = document.querySelector(\"video#video1\");\n  const video2 = document.querySelector(\"video#video2\");\n  const video3 = document.querySelector(\"video#video3\");\n  let pc1Local;\n  let pc1Remote;\n  let pc2Local;\n  let pc2Remote;\n  const offerOptions = {\n    offerToReceiveAudio: 1,\n    offerToReceiveVideo: 1\n  };\n\n  function gotStream(stream) {\n    console.log(\"Received local stream\");\n    video1.srcObject = stream;\n    window.localStream = stream;\n    callButton.disabled = false;\n  }\n\n  function start() {\n    console.log(\"Requesting local stream\");\n    startButton.disabled = true;\n    navigator.mediaDevices.getUserMedia({\n      audio: true,\n      video: true\n    }).then(gotStream).catch(e => console.log(\"getUserMedia() error: \", e));\n  }\n\n  function call() {\n    callButton.disabled = true;\n    hangupButton.disabled = false;\n    console.log(\"Starting calls\");\n    const audioTracks = window.localStream.getAudioTracks();\n    const videoTracks = window.localStream.getVideoTracks();\n\n    if (audioTracks.length > 0) {\n      console.log(`Using audio device: ${audioTracks[0].label}`);\n    }\n\n    if (videoTracks.length > 0) {\n      console.log(`Using video device: ${videoTracks[0].label}`);\n    } // Create an RTCPeerConnection via the polyfill.\n\n\n    const servers = null;\n    pc1Local = new RTCPeerConnection(servers);\n    pc1Remote = new RTCPeerConnection(servers);\n    pc1Remote.ontrack = gotRemoteStream1;\n    pc1Local.onicecandidate = iceCallback1Local;\n    pc1Remote.onicecandidate = iceCallback1Remote;\n    console.log(\"pc1: created local and remote peer connection objects\");\n    pc2Local = new RTCPeerConnection(servers);\n    pc2Remote = new RTCPeerConnection(servers);\n    pc2Remote.ontrack = gotRemoteStream2;\n    pc2Local.onicecandidate = iceCallback2Local;\n    pc2Remote.onicecandidate = iceCallback2Remote;\n    console.log(\"pc2: created local and remote peer connection objects\");\n    window.localStream.getTracks().forEach(track => pc1Local.addTrack(track, window.localStream));\n    console.log(\"Adding local stream to pc1Local\");\n    pc1Local.createOffer(offerOptions).then(gotDescription1Local, onCreateSessionDescriptionError);\n    window.localStream.getTracks().forEach(track => pc2Local.addTrack(track, window.localStream));\n    console.log(\"Adding local stream to pc2Local\");\n    pc2Local.createOffer(offerOptions).then(gotDescription2Local, onCreateSessionDescriptionError);\n  }\n\n  function onCreateSessionDescriptionError(error) {\n    console.log(`Failed to create session description: ${error.toString()}`);\n  }\n\n  function gotDescription1Local(desc) {\n    pc1Local.setLocalDescription(desc);\n    console.log(`Offer from pc1Local\\n${desc.sdp}`);\n    pc1Remote.setRemoteDescription(desc); // Since the 'remote' side has no media stream we need\n    // to pass in the right constraints in order for it to\n    // accept the incoming offer of audio and video.\n\n    pc1Remote.createAnswer().then(gotDescription1Remote, onCreateSessionDescriptionError);\n  }\n\n  function gotDescription1Remote(desc) {\n    pc1Remote.setLocalDescription(desc);\n    console.log(`Answer from pc1Remote\\n${desc.sdp}`);\n    pc1Local.setRemoteDescription(desc);\n  }\n\n  function gotDescription2Local(desc) {\n    pc2Local.setLocalDescription(desc);\n    console.log(`Offer from pc2Local\\n${desc.sdp}`);\n    pc2Remote.setRemoteDescription(desc); // Since the 'remote' side has no media stream we need\n    // to pass in the right constraints in order for it to\n    // accept the incoming offer of audio and video.\n\n    pc2Remote.createAnswer().then(gotDescription2Remote, onCreateSessionDescriptionError);\n  }\n\n  function gotDescription2Remote(desc) {\n    pc2Remote.setLocalDescription(desc);\n    console.log(`Answer from pc2Remote\\n${desc.sdp}`);\n    pc2Local.setRemoteDescription(desc);\n  }\n\n  function hangup() {\n    console.log(\"Ending calls\");\n    pc1Local.close();\n    pc1Remote.close();\n    pc2Local.close();\n    pc2Remote.close();\n    pc1Local = pc1Remote = null;\n    pc2Local = pc2Remote = null;\n    hangupButton.disabled = true;\n    callButton.disabled = false;\n  }\n\n  function gotRemoteStream1(e) {\n    if (video2.srcObject !== e.streams[0]) {\n      video2.srcObject = e.streams[0];\n      console.log(\"pc1: received remote stream\");\n    }\n  }\n\n  function gotRemoteStream2(e) {\n    if (video3.srcObject !== e.streams[0]) {\n      video3.srcObject = e.streams[0];\n      console.log(\"pc2: received remote stream\");\n    }\n  }\n\n  function iceCallback1Local(event) {\n    handleCandidate(event.candidate, pc1Remote, \"pc1: \", \"local\");\n  }\n\n  function iceCallback1Remote(event) {\n    handleCandidate(event.candidate, pc1Local, \"pc1: \", \"remote\");\n  }\n\n  function iceCallback2Local(event) {\n    handleCandidate(event.candidate, pc2Remote, \"pc2: \", \"local\");\n  }\n\n  function iceCallback2Remote(event) {\n    handleCandidate(event.candidate, pc2Local, \"pc2: \", \"remote\");\n  }\n\n  function handleCandidate(candidate, dest, prefix, type) {\n    dest.addIceCandidate(candidate).then(onAddIceCandidateSuccess, onAddIceCandidateError);\n    console.log(`${prefix}New ${type} ICE candidate: ${candidate ? candidate.candidate : \"(null)\"}`);\n  }\n\n  function onAddIceCandidateSuccess() {\n    console.log(\"AddIceCandidate success.\");\n  }\n\n  function onAddIceCandidateError(error) {\n    console.log(`Failed to add ICE candidate: ${error.toString()}`);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [/*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"//webrtc.github.io/samples/\",\n        title: \"WebRTC samples homepage\",\n        children: \"WebRTC samples\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Multiple peer connections\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      id: \"video1\",\n      playsinline: true,\n      autoplay: true,\n      muted: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      id: \"video2\",\n      playsinline: true,\n      autoplay: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      id: \"video3\",\n      playsinline: true,\n      autoplay: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        id: \"startButton\",\n        disabled: startButtonDisabled,\n        children: \"Start\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        id: \"callButton\",\n        disabled: callButtonDisabled,\n        children: \"Call\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        id: \"hangupButton\",\n        disabled: hangupButtonDis,\n        children: \"Hang Up\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"View the console to see logging and to inspect the\", \" \", /*#__PURE__*/_jsxDEV(\"code\", {\n        children: \"MediaStream\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this), \" object \", /*#__PURE__*/_jsxDEV(\"code\", {\n        children: \"localStream\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 41\n      }, this), \".\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"For more information about RTCPeerConnection, see\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"http://www.html5rocks.com/en/tutorials/webrtc/basics/\",\n        title: \"HTML5 Rocks article about WebRTC by Sam Dutton\",\n        children: \"Getting Started With WebRTC\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this), \".\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"https://github.com/webrtc/samples/tree/gh-pages/src/content/peerconnection/multiple\",\n      title: \"View source for this page on GitHub\",\n      id: \"viewSource\",\n      children: \"View source on GitHub\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 193,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"vxs1aOziRmARjcAX9L7M+d4xm4w=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/ngjunwei/audio-room-2/src/App.js"],"names":["useState","App","startButtonDisabled","callButtonDisabled","hangupButtonDisabled","callButton","disabled","hangupButton","startButton","onclick","start","call","hangup","video1","document","querySelector","video2","video3","pc1Local","pc1Remote","pc2Local","pc2Remote","offerOptions","offerToReceiveAudio","offerToReceiveVideo","gotStream","stream","console","log","srcObject","window","localStream","navigator","mediaDevices","getUserMedia","audio","video","then","catch","e","audioTracks","getAudioTracks","videoTracks","getVideoTracks","length","label","servers","RTCPeerConnection","ontrack","gotRemoteStream1","onicecandidate","iceCallback1Local","iceCallback1Remote","gotRemoteStream2","iceCallback2Local","iceCallback2Remote","getTracks","forEach","track","addTrack","createOffer","gotDescription1Local","onCreateSessionDescriptionError","gotDescription2Local","error","toString","desc","setLocalDescription","sdp","setRemoteDescription","createAnswer","gotDescription1Remote","gotDescription2Remote","close","streams","event","handleCandidate","candidate","dest","prefix","type","addIceCandidate","onAddIceCandidateSuccess","onAddIceCandidateError","hangupButtonDis"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\n\nfunction App() {\n  const startButtonDisabled = useState(\"false\");\n  const callButtonDisabled = useState(\"true\");\n  const hangupButtonDisabled = useState(\"true\");\n\n  callButton.disabled = true;\n  hangupButton.disabled = true;\n  startButton.onclick = start;\n  callButton.onclick = call;\n  hangupButton.onclick = hangup;\n\n  const video1 = document.querySelector(\"video#video1\");\n  const video2 = document.querySelector(\"video#video2\");\n  const video3 = document.querySelector(\"video#video3\");\n\n  let pc1Local;\n  let pc1Remote;\n  let pc2Local;\n  let pc2Remote;\n  const offerOptions = {\n    offerToReceiveAudio: 1,\n    offerToReceiveVideo: 1,\n  };\n\n  function gotStream(stream) {\n    console.log(\"Received local stream\");\n    video1.srcObject = stream;\n    window.localStream = stream;\n    callButton.disabled = false;\n  }\n\n  function start() {\n    console.log(\"Requesting local stream\");\n    startButton.disabled = true;\n    navigator.mediaDevices\n      .getUserMedia({\n        audio: true,\n        video: true,\n      })\n      .then(gotStream)\n      .catch((e) => console.log(\"getUserMedia() error: \", e));\n  }\n\n  function call() {\n    callButton.disabled = true;\n    hangupButton.disabled = false;\n    console.log(\"Starting calls\");\n    const audioTracks = window.localStream.getAudioTracks();\n    const videoTracks = window.localStream.getVideoTracks();\n    if (audioTracks.length > 0) {\n      console.log(`Using audio device: ${audioTracks[0].label}`);\n    }\n    if (videoTracks.length > 0) {\n      console.log(`Using video device: ${videoTracks[0].label}`);\n    }\n    // Create an RTCPeerConnection via the polyfill.\n    const servers = null;\n    pc1Local = new RTCPeerConnection(servers);\n    pc1Remote = new RTCPeerConnection(servers);\n    pc1Remote.ontrack = gotRemoteStream1;\n    pc1Local.onicecandidate = iceCallback1Local;\n    pc1Remote.onicecandidate = iceCallback1Remote;\n    console.log(\"pc1: created local and remote peer connection objects\");\n\n    pc2Local = new RTCPeerConnection(servers);\n    pc2Remote = new RTCPeerConnection(servers);\n    pc2Remote.ontrack = gotRemoteStream2;\n    pc2Local.onicecandidate = iceCallback2Local;\n    pc2Remote.onicecandidate = iceCallback2Remote;\n    console.log(\"pc2: created local and remote peer connection objects\");\n\n    window.localStream\n      .getTracks()\n      .forEach((track) => pc1Local.addTrack(track, window.localStream));\n    console.log(\"Adding local stream to pc1Local\");\n    pc1Local\n      .createOffer(offerOptions)\n      .then(gotDescription1Local, onCreateSessionDescriptionError);\n\n    window.localStream\n      .getTracks()\n      .forEach((track) => pc2Local.addTrack(track, window.localStream));\n    console.log(\"Adding local stream to pc2Local\");\n    pc2Local\n      .createOffer(offerOptions)\n      .then(gotDescription2Local, onCreateSessionDescriptionError);\n  }\n\n  function onCreateSessionDescriptionError(error) {\n    console.log(`Failed to create session description: ${error.toString()}`);\n  }\n\n  function gotDescription1Local(desc) {\n    pc1Local.setLocalDescription(desc);\n    console.log(`Offer from pc1Local\\n${desc.sdp}`);\n    pc1Remote.setRemoteDescription(desc);\n    // Since the 'remote' side has no media stream we need\n    // to pass in the right constraints in order for it to\n    // accept the incoming offer of audio and video.\n    pc1Remote\n      .createAnswer()\n      .then(gotDescription1Remote, onCreateSessionDescriptionError);\n  }\n\n  function gotDescription1Remote(desc) {\n    pc1Remote.setLocalDescription(desc);\n    console.log(`Answer from pc1Remote\\n${desc.sdp}`);\n    pc1Local.setRemoteDescription(desc);\n  }\n\n  function gotDescription2Local(desc) {\n    pc2Local.setLocalDescription(desc);\n    console.log(`Offer from pc2Local\\n${desc.sdp}`);\n    pc2Remote.setRemoteDescription(desc);\n    // Since the 'remote' side has no media stream we need\n    // to pass in the right constraints in order for it to\n    // accept the incoming offer of audio and video.\n    pc2Remote\n      .createAnswer()\n      .then(gotDescription2Remote, onCreateSessionDescriptionError);\n  }\n\n  function gotDescription2Remote(desc) {\n    pc2Remote.setLocalDescription(desc);\n    console.log(`Answer from pc2Remote\\n${desc.sdp}`);\n    pc2Local.setRemoteDescription(desc);\n  }\n\n  function hangup() {\n    console.log(\"Ending calls\");\n    pc1Local.close();\n    pc1Remote.close();\n    pc2Local.close();\n    pc2Remote.close();\n    pc1Local = pc1Remote = null;\n    pc2Local = pc2Remote = null;\n    hangupButton.disabled = true;\n    callButton.disabled = false;\n  }\n\n  function gotRemoteStream1(e) {\n    if (video2.srcObject !== e.streams[0]) {\n      video2.srcObject = e.streams[0];\n      console.log(\"pc1: received remote stream\");\n    }\n  }\n\n  function gotRemoteStream2(e) {\n    if (video3.srcObject !== e.streams[0]) {\n      video3.srcObject = e.streams[0];\n      console.log(\"pc2: received remote stream\");\n    }\n  }\n\n  function iceCallback1Local(event) {\n    handleCandidate(event.candidate, pc1Remote, \"pc1: \", \"local\");\n  }\n\n  function iceCallback1Remote(event) {\n    handleCandidate(event.candidate, pc1Local, \"pc1: \", \"remote\");\n  }\n\n  function iceCallback2Local(event) {\n    handleCandidate(event.candidate, pc2Remote, \"pc2: \", \"local\");\n  }\n\n  function iceCallback2Remote(event) {\n    handleCandidate(event.candidate, pc2Local, \"pc2: \", \"remote\");\n  }\n\n  function handleCandidate(candidate, dest, prefix, type) {\n    dest\n      .addIceCandidate(candidate)\n      .then(onAddIceCandidateSuccess, onAddIceCandidateError);\n    console.log(\n      `${prefix}New ${type} ICE candidate: ${\n        candidate ? candidate.candidate : \"(null)\"\n      }`\n    );\n  }\n\n  function onAddIceCandidateSuccess() {\n    console.log(\"AddIceCandidate success.\");\n  }\n\n  function onAddIceCandidateError(error) {\n    console.log(`Failed to add ICE candidate: ${error.toString()}`);\n  }\n\n  return (\n    <div id=\"container\">\n      <h1>\n        <a href=\"//webrtc.github.io/samples/\" title=\"WebRTC samples homepage\">\n          WebRTC samples\n        </a>{\" \"}\n        <span>Multiple peer connections</span>\n      </h1>\n\n      <video id=\"video1\" playsinline autoplay muted></video>\n      <video id=\"video2\" playsinline autoplay></video>\n      <video id=\"video3\" playsinline autoplay></video>\n\n      <div>\n        <button id=\"startButton\" disabled={startButtonDisabled}>\n          Start\n        </button>\n        <button id=\"callButton\" disabled={callButtonDisabled}>\n          Call\n        </button>\n        <button id=\"hangupButton\" disabled={hangupButtonDis}>\n          Hang Up\n        </button>\n      </div>\n\n      <p>\n        View the console to see logging and to inspect the{\" \"}\n        <code>MediaStream</code> object <code>localStream</code>.\n      </p>\n\n      <p>\n        For more information about RTCPeerConnection, see{\" \"}\n        <a\n          href=\"http://www.html5rocks.com/en/tutorials/webrtc/basics/\"\n          title=\"HTML5 Rocks article about WebRTC by Sam Dutton\"\n        >\n          Getting Started With WebRTC\n        </a>\n        .\n      </p>\n\n      <a\n        href=\"https://github.com/webrtc/samples/tree/gh-pages/src/content/peerconnection/multiple\"\n        title=\"View source for this page on GitHub\"\n        id=\"viewSource\"\n      >\n        View source on GitHub\n      </a>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}